#!/usr/bin/ruby
require           'optparse'
require           'rubygems'
gem               'aws-sdk'
require           'aws-sdk'

# Options Parsing
options = {}
optparse = OptionParser.new do |opts|
  opts.banner = "Usage: #{File.basename($PROGRAM_NAME)} [options]"

  # Define the options, and what they do
  options[:no_update] = false
  opts.on('--no-update', 'Do not update crontab after making leader') do
    options[:no_update] = true
  end

  # This displays the help screen, all programs are
  # assumed to have this option.
  opts.on('-h', '--help', 'Display this screen') do
    puts opts
    exit
  end
end
optparse.parse!

# Create the new Whenever::Elasticbeanstalk instance
whenever_eb = Whenever::Elasticbeanstalk.new(Aws::InstanceProfileCredentials.new)
# Create the cron leader
whenever_eb.create_cron_leader(no_update: options[:no_update])
